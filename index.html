<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trade Board Pro</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<!-- FontAwesome -->
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

<style>
body, html{margin:0;padding:0;font-family:'Segoe UI',sans-serif;background:#121212;color:#e0e0e0;}
header{background:#1a73e8;color:white;padding:1rem;text-align:center;font-size:1.8rem;font-weight:bold;}
nav{display:flex;justify-content:space-around;background:#1f1f1f;padding:0.5rem 0;position:sticky;top:0;z-index:10;}
nav button{padding:0.6rem 1.2rem;border:none;border-radius:6px;font-weight:bold;cursor:pointer;background:#333;color:#39ff14;transition:0.3s;}
nav button.active{background:#39ff14;color:#121212;}
section{padding:1rem;}
.card{background:#1e1e1e;margin-bottom:1rem;padding:1rem;border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,0.3);}
input,textarea,select{width:100%;padding:0.4rem;margin:0.2rem 0;border-radius:5px;border:1px solid #555;background:#121212;color:#39ff14;}
button.authButton{background:#39ff14;color:#121212;padding:0.5rem;border:none;border-radius:6px;cursor:pointer;width:100%;margin-top:0.5rem;transition:0.2s;}
button.authButton:hover{background:#28c000;}
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:1px;background:#333;border-radius:8px;overflow:hidden;margin-bottom:1rem;}
.calendar div{background:#1e1e1e;min-height:80px;padding:0.4rem;position:relative;font-size:0.9rem;cursor:pointer;transition:0.3s;}
.calendar div:hover{background:#2a2a2a;}
.entry{margin-top:1.2rem;font-size:0.75rem;display:flex;align-items:center;transition:0.2s;}
.entry i{margin-right:5px;}
.entry .gain{color:green;font-weight:bold;}
.entry .loss{color:red;font-weight:bold;}
#authContainer{max-width:400px;margin:1rem auto;background:#1e1e1e;padding:1rem;border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,0.3);}
</style>
</head>
<body>

<header>Trade Board Pro</header>

<div id="authContainer">
  <h2>Connexion / Créer un compte</h2>
  <input type="email" id="authEmail" placeholder="Adresse e-mail">
  <input type="password" id="authPassword" placeholder="Mot de passe">
  <button class="authButton" id="signInBtn">Se connecter</button>
  <button class="authButton" id="signUpBtn">Créer un compte</button>
  <button class="authButton" id="signOutBtn" style="display:none;">Se déconnecter</button>
  <div id="emailWarning" style="color:red;font-size:0.85rem;display:none;margin-top:0.5rem;">Email non vérifié !</div>
</div>

<nav style="display:none;" id="mainNav">
  <button id="tab-news" class="active">Actualité</button>
  <button id="tab-strategies">Stratégies</button>
  <button id="tab-calendar">Calendrier</button>
</nav>

<section id="section-news" style="display:none;">
  <h2>Résumé marchés / News</h2>
  <div class="card">
    <p>Widget résumé des marchés (ex: Gold, EUR/USD, BTC)</p>
    <p>Pour l'instant, informations simulées. Plus tard, intégration en temps réel possible.</p>
  </div>
  <div class="card">
    <p>Citations trading :</p>
    <p>"Tradez avec votre cerveau, pas vos émotions." - Alexander Elder</p>
    <p>"Le marché peut rester irrationnel plus longtemps que vous ne pouvez rester solvable." - John Maynard Keynes</p>
  </div>
</section>

<section id="section-strategies" style="display:none;">
  <h2>Mes stratégies</h2>
  <div id="strategyContainer" class="card"></div>
  <button id="addStrategyBtn" class="authButton">Ajouter une stratégie</button>
</section>

<section id="section-calendar" style="display:none;">
  <h2>Calendrier & Journal</h2>
  <div style="display:flex;justify-content:space-between;margin-bottom:0.5rem;">
    <button id="prevMonth">&lt; Mois précédent</button>
    <span id="currentMonth" style="font-weight:bold;"></span>
    <button id="nextMonth">Mois suivant &gt;</button>
  </div>
  <div class="calendar" id="calendar"></div>
</section>

<script>
// --- Firebase config ---
const firebaseConfig = {
  apiKey: "AIzaSyACFzFXKK_1EH6_PVgaQQXD3fc8mBvQRvg",
  authDomain: "perso-journaling.firebaseapp.com",
  projectId: "perso-journaling",
  storageBucket: "perso-journaling.firebasestorage.app",
  messagingSenderId: "660360215177",
  appId: "1:660360215177:web:WEBAPPID_A_REMPLACER"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// --- Navigation ---
const mainNav = document.getElementById("mainNav");
const sectionNews = document.getElementById("section-news");
const sectionStrategies = document.getElementById("section-strategies");
const sectionCalendar = document.getElementById("section-calendar");

function showSection(section){
  sectionNews.style.display="none";
  sectionStrategies.style.display="none";
  sectionCalendar.style.display="none";
  switch(section){
    case "news": sectionNews.style.display="block"; break;
    case "strategies": sectionStrategies.style.display="block"; break;
    case "calendar": sectionCalendar.style.display="block"; break;
  }
  document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
  document.getElementById("tab-"+section).classList.add("active");
}

document.getElementById("tab-news").addEventListener("click",()=>{showSection("news");});
document.getElementById("tab-strategies").addEventListener("click",()=>{showSection("strategies");});
document.getElementById("tab-calendar").addEventListener("click",()=>{showSection("calendar");});

// --- Auth ---
const authContainer = document.getElementById("authContainer");
const signOutBtn = document.getElementById("signOutBtn");
const emailWarning = document.getElementById("emailWarning");

auth.onAuthStateChanged(user=>{
  if(user){
    if(!user.emailVerified){emailWarning.style.display="block"; auth.signOut(); return;}
    emailWarning.style.display="none";
    authContainer.style.display="none";
    mainNav.style.display="flex";
    showSection("news"); // News en premier onglet
    loadStrategies();
    renderCalendar();
  } else {
    authContainer.style.display="block";
    mainNav.style.display="none";
    sectionNews.style.display="none";
    sectionStrategies.style.display="none";
    sectionCalendar.style.display="none";
  }
});

document.getElementById("signInBtn").addEventListener("click",()=>{
  const email=document.getElementById("authEmail").value;
  const password=document.getElementById("authPassword").value;
  auth.signInWithEmailAndPassword(email,password).catch(err=>alert(err.message));
});

document.getElementById("signUpBtn").addEventListener("click",async()=>{
  const email=prompt("Email:");
  const password=prompt("Mot de passe:");
  try{
    const userCredential=await auth.createUserWithEmailAndPassword(email,password);
    const user=userCredential.user;
    await user.sendEmailVerification();
    alert("Compte créé ! Vérifiez votre email.");
  }catch(err){alert(err.message);}
});

signOutBtn.addEventListener("click",()=>auth.signOut());

// --- Stratégies ---
const strategyContainer = document.getElementById("strategyContainer");
const addStrategyBtn = document.getElementById("addStrategyBtn");
let strategies = [];

function renderStrategies(){
  strategyContainer.innerHTML="";
  strategies.forEach((str,i)=>{
    const div = document.createElement("div");
    div.className="card";
    div.innerHTML=`<strong>${str.name}</strong><br><textarea class="conditionInput">${str.conditions.join("\n")}</textarea>
    <button class="saveStrategy authButton">Sauvegarder</button>
    <button class="deleteStrategy authButton">Supprimer</button>`;
    strategyContainer.appendChild(div);

    div.querySelector(".saveStrategy").addEventListener("click",()=>{
      strategies[i].conditions = div.querySelector(".conditionInput").value.split("\n");
    });
    div.querySelector(".deleteStrategy").addEventListener("click",()=>{
      strategies.splice(i,1);
      renderStrategies();
    });
  });
}

addStrategyBtn.addEventListener("click",()=>{
  const name = prompt("Nom de la stratégie:");
  if(!name) return;
  strategies.push({name,conditions:[]});
  renderStrategies();
});

function loadStrategies(){renderStrategies();}

// --- Calendrier ---
const calendarEl = document.getElementById("calendar");
let today = new Date();
let currentMonth = today.getMonth();
let currentYear = today.getFullYear();
let entries = {};

function renderCalendar(){
  calendarEl.innerHTML="";
  const firstDay = new Date(currentYear,currentMonth,1).getDay();
  const lastDate = new Date(currentYear,currentMonth+1,0).getDate();
  for(let i=0;i<firstDay;i++) calendarEl.appendChild(document.createElement("div"));
  for(let d=1;d<=lastDate;d++){
    const div = document.createElement("div");
    const dateStr = `${currentYear}-${String(currentMonth+1).padStart(2,"0")}-${String(d).padStart(2,"0")}`;
    div.textContent=d;
    calendarEl.appendChild(div);
  }
  document.getElementById("currentMonth").textContent=new Date(currentYear,currentMonth).toLocaleString('fr-FR',{month:'long',year:'numeric'});
}

document.getElementById("prevMonth").addEventListener("click",()=>{currentMonth--; if(currentMonth<0){currentMonth=11; currentYear--;} renderCalendar();});
document.getElementById("nextMonth").addEventListener("click",()=>{currentMonth++; if(currentMonth>11){currentMonth=0; currentYear++;} renderCalendar();});
</script>

</body>
</html>
