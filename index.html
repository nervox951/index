<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trade Board Pro</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
<style>
body, html { margin:0; padding:0; font-family:'Segoe UI',sans-serif; background:#1e1e1e; color:#fff; overflow-x:hidden;}
/* Écran accueil dynamique */
#introScreen{position:fixed;top:0;left:0;width:100%;height:100%;background:#111;color:#0f0;display:flex;justify-content:center;align-items:center;flex-direction:column;transition:transform 0.8s ease-out;z-index:100;cursor:pointer;}
#introScreen.hide{transform:translateX(-100%);}
#introScreen h1{font-size:3rem;margin:0;}
#introScreen p{font-size:1.2rem;margin-top:1rem;text-align:center;max-width:600px;line-height:1.4;}

/* Header et navigation */
header{background:#0f0;color:#111;padding:1rem;text-align:center;font-size:1.8rem;font-weight:bold;position:sticky;top:0;z-index:50;}
nav{display:flex;justify-content:space-around;background:#222;padding:0.5rem 0;position:sticky;top:60px;z-index:40;}
nav button{padding:0.6rem 1.2rem;border:none;border-radius:6px;font-weight:bold;cursor:pointer;transition:0.3s;background:#444;color:#fff;}
nav button.active{background:#0f0;color:#111;}

/* Sections */
section{padding:1rem;}
.strategy, .calendar-container{background:#333;margin-bottom:1rem;padding:1rem;border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,0.5);}
.progress-bar{height:20px;background:#555;border-radius:10px;overflow:hidden;margin-top:0.5rem;}
.progress-bar-inner{height:100%;background:#0f0;width:0%;text-align:center;color:#111;line-height:20px;font-size:0.85rem;}

/* Calendrier */
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:1px;background:#222;border-radius:8px;overflow:hidden;}
.calendar div{background:#333;min-height:80px;padding:0.4rem;position:relative;font-size:0.9rem;cursor:pointer;transition:0.3s;}
.calendar div:hover{background:#444;}
.calendar div span{position:absolute;top:3px;right:5px;font-size:0.75rem;font-weight:bold;}
.entry{margin-top:1.2rem;font-size:0.75rem;display:flex;align-items:center;transition:0.2s;}
.entry i{margin-right:5px;}
.entry .gain{color:#0f0;font-weight:bold;}
.entry .loss{color:red;font-weight:bold;}

/* Inputs */
input,textarea,select{width:100%;padding:0.4rem;margin:0.2rem 0;border-radius:5px;border:1px solid #555;background:#222;color:#fff;}
button.addEntry,button.authButton{background:#0f0;color:#111;padding:0.5rem;border:none;border-radius:6px;cursor:pointer;width:100%;margin-top:0.5rem;transition:0.2s;}
button.addEntry:hover,button.authButton:hover{background:#0b0;}

/* Auth container */
#authContainer{max-width:400px;margin:1rem auto;background:#222;padding:1rem;border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,0.5);}
#signOutBtn{margin-top:0.5rem;}

/* Actualités */
#newsContainer{background:#222;padding:1rem;margin-bottom:1rem;border-radius:10px;overflow:hidden;}
.newsItem{margin-bottom:0.5rem;}
.newsItem a{color:#0f0;text-decoration:none;}
.newsItem a:hover{text-decoration:underline;}

/* Images par jour */
#imageContainer{background:#222;padding:1rem;margin-bottom:1rem;border-radius:10px;}
#imageContainer img{max-width:100px;margin:5px;border-radius:6px;}
</style>
</head>
<body>

<!-- Écran accueil -->
<div id="introScreen">
  <h1>Trade Board Pro</h1>
  <p>Bienvenue sur votre application de suivi de stratégies et journal de trading.<br>Planifiez, suivez vos positions et analysez vos performances facilement.<br>"Le succès en trading vient de la discipline et de l'organisation."</p>
</div>

<header id="mainHeader">Trade Board Pro</header>

<!-- Auth -->
<div id="authContainer">
  <h2>Connexion</h2>
  <input type="email" id="authEmail" placeholder="Adresse e-mail">
  <input type="password" id="authPassword" placeholder="Mot de passe">
  <button class="authButton" id="signInBtn">Se connecter</button>
  <button class="authButton" id="signUpBtn">Créer un compte</button>
  <button class="authButton" id="signOutBtn" style="display:none;">Se déconnecter</button>
  <div id="emailWarning" style="color:red;font-size:0.85rem;display:none;margin-top:0.5rem;">Email non vérifié !</div>
</div>

<!-- Menu -->
<nav style="display:none;" id="mainNav">
  <button id="tab-news" class="active">Actualités</button>
  <button id="tab-strategies">Stratégies</button>
  <button id="tab-calendar">Calendrier</button>
  <button id="tab-images">Images</button>
</nav>

<!-- Sections -->
<section id="section-news" style="display:none;">
  <h2>Actualités financières</h2>
  <div id="newsContainer"></div>
  <!-- Widget Calendrier économique -->
  <iframe src="https://www.investing.com/economic-calendar/" style="width:100%;height:500px;border:none;border-radius:10px;margin-top:1rem;"></iframe>
</section>

<section id="section-strategies" style="display:none;">
  <h2>Mes stratégies</h2>
  <div id="strategiesContainer"></div>
  <button class="authButton" id="addStrategyBtn">Ajouter une stratégie</button>
</section>

<section id="section-calendar" style="display:none;">
  <h2>Calendrier & Journal</h2>
  <div style="display:flex;justify-content:space-between;margin-bottom:0.5rem;">
    <button id="prevMonth">&lt; Mois précédent</button>
    <span id="currentMonth" style="font-weight:bold;"></span>
    <button id="nextMonth">Mois suivant &gt;</button>
  </div>
  <div class="calendar" id="calendar"></div>
  <div id="entryForm" style="margin-top:1rem;">
    <input type="date" id="entryDate">
    <select id="entryAsset">
      <option value="EURUSD">EUR/USD</option>
      <option value="XAUUSD">XAU/USD (Gold)</option>
      <option value="USDX">US Dollar Index</option>
      <option value="BTCUSD">BTC/USD</option>
      <option value="ETHUSD">ETH/USD</option>
      <option value="DJ30">DJ30</option>
      <option value="NAS100">NAS100</option>
      <option value="AUTRE">Ajouter un actif...</option>
    </select>
    <select id="entryType"><option value="achat">Achat</option><option value="vente">Vente</option></select>
    <input type="number" id="entryPrice" placeholder="Prix">
    <input type="number" id="entryResult" placeholder="Résultat (gain/perte)">
    <textarea id="entryDescription" placeholder="Description"></textarea>
    <button class="addEntry">Ajouter l'entrée</button>
  </div>
</section>

<section id="section-images" style="display:none;">
  <h2>Images par jour</h2>
  <input type="file" id="imageInput" multiple>
  <button class="authButton" id="addImageBtn">Ajouter image</button>
  <div id="imageContainer"></div>
</section>

<script>
// --- Firebase config ---
const firebaseConfig = {
  apiKey: "VOTRE_CLE_API",
  authDomain: "VOTRE_PROJECT.firebaseapp.com",
  projectId: "VOTRE_PROJECT",
  storageBucket: "VOTRE_PROJECT.appspot.com",
  messagingSenderId: "xxxx",
  appId: "xxxxx"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// --- Intro dynamique ---
const introScreen = document.getElementById("introScreen");
function hideIntro() { introScreen.classList.add("hide"); setTimeout(()=>{introScreen.style.display="none";},800);}
setTimeout(hideIntro,3000);
introScreen.addEventListener("click",hideIntro);

// --- Sections et onglets ---
const mainNav = document.getElementById("mainNav");
const sections = {
  news: document.getElementById("section-news"),
  strategies: document.getElementById("section-strategies"),
  calendar: document.getElementById("section-calendar"),
  images: document.getElementById("section-images")
};
document.getElementById("tab-news").addEventListener("click",()=>{showSection("news");});
document.getElementById("tab-strategies").addEventListener("click",()=>{showSection("strategies");});
document.getElementById("tab-calendar").addEventListener("click",()=>{showSection("calendar");});
document.getElementById("tab-images").addEventListener("click",()=>{showSection("images");});
function showSection(sec){
  for(let s in sections){sections[s].style.display="none";}
  sections[sec].style.display="block";
  document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
  document.getElementById("tab-"+sec).classList.add("active");
}

// --- Auth ---
const authContainer = document.getElementById("authContainer");
const signOutBtn = document.getElementById("signOutBtn");
auth.onAuthStateChanged(user=>{
  if(user){
    if(!user.emailVerified){alert("Vérifiez votre email !"); auth.signOut(); return;}
    authContainer.style.display="none";
    mainNav.style.display="flex";
    showSection("news");
    loadUserData(user.uid);
  } else {
    authContainer.style.display="block";
    mainNav.style.display="none";
  }
});
document.getElementById("signInBtn").addEventListener("click",()=>{
  const email=document.getElementById("authEmail").value;
  const password=document.getElementById("authPassword").value;
  auth.signInWithEmailAndPassword(email,password).catch(err=>alert(err.message));
});
document.getElementById("signUpBtn").addEventListener("click",async()=>{
  const email=prompt("Email:");
  const password=prompt("Mot de passe:");
  try{
    const user=await auth.createUserWithEmailAndPassword(email,password);
    await user.user.sendEmailVerification();
    alert("Compte créé ! Vérifiez votre email.");
  }catch(err){alert(err.message);}
});
signOutBtn.addEventListener("click",()=>auth.signOut());

// --- News ---
const newsContainer = document.getElementById("newsContainer");
async function loadNews(){
  // Exemple simple à remplacer par API ou flux RSS
  const sampleNews = [
    {title:"Gold progresse après la demande asiatique",link:"#"},
    {title:"Dollar corrigé suite aux annonces économiques",link:"#"},
    {title:"Bitcoin en hausse continue",link:"#"}
  ];
  newsContainer.innerHTML="";
  sampleNews.forEach(n=>{
    const div = document.createElement("div");
    div.className="newsItem";
    div.innerHTML=`<a href="${n.link}" target="_blank">${n.title}</a>`;
    newsContainer.appendChild(div);
  });
}
loadNews();

// --- Stratégies ---
const strategiesContainer = document.getElementById("strategiesContainer");
document.getElementById("addStrategyBtn").addEventListener("click",()=>{
  const div = document.createElement("div");
  div.className="strategy";
  div.innerHTML=`<input type="text" placeholder="Nom stratégie"><button class="deleteStrategyBtn">Supprimer</button><div class="conditionsContainer"></div><button class="addConditionBtn">Ajouter condition</button>`;
  strategiesContainer.appendChild(div);
  div.querySelector(".deleteStrategyBtn").addEventListener("click",()=>div.remove());
  div.querySelector(".addConditionBtn").addEventListener("click",()=>{
    const cond = document.createElement("input");
    cond.placeholder="Nouvelle condition";
    div.querySelector(".conditionsContainer").appendChild(cond);
  });
});

// --- Calendrier (voir script précédent) ---
// ... copier le script complet du calendrier ici comme fourni dans la réponse précédente ...

// --- Images ---
const imageInput = document.getElementById("imageInput");
const imageContainer = document.getElementById("imageContainer");
document.getElementById("addImageBtn").addEventListener("click", async()=>{
  const user = auth.currentUser;
  if(!user){alert("Connecte-toi"); return;}
  const files = imageInput.files;
  for(let f=0;f<files.length;f++){
    const file = files[f];
    const reader = new FileReader();
    reader.onload = async (e)=>{
      const dataURL = e.target.result;
      const img = document.createElement("img");
      img.src=dataURL;
      imageContainer.appendChild(img);
      // Sauvegarde Firestore
      await db.collection("users").doc(user.uid).collection("images").add({dataURL, date:new Date().toISOString()});
    };
    reader.readAsDataURL(file);
  }
  imageInput.value="";
});

// --- Charger les données utilisateur ---
async function loadUserData(uid){
  // Calendrier
  entries={};
  const snapshot = await db.collection("users").doc(uid).collection("journal").get();
  snapshot.forEach(doc=>{
    const data = doc.data();
    if(!entries[data.date]) entries[data.date]=[];
    entries[data.date].push({asset:data.asset,type:data.type,price:data.price,result:data.result,desc:data.desc});
  });
  renderCalendar();

  // Images
  const imagesSnap = await db.collection("users").doc(uid).collection("images").get();
  imageContainer.innerHTML="";
  imagesSnap.forEach(doc=>{
    const data = doc.data();
    const img = document.createElement("img");
    img.src=data.dataURL;
    imageContainer.appendChild(img);
  });
}
</script>
</body>
</html>
